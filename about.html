<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>About - Stories of You</title>
  <meta name="description" content="Learn about Michael and the personal story behind Stories of You - preserving family memories for generations." />
  <link rel="icon" href="favicon.ico" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="About - Stories of You" />
  <meta property="og:description" content="The personal story behind Stories of You and our mission to preserve family memories." />
  <meta property="og:image" content="og-image.jpg" />
  <meta property="og:url" content="https://storiesofyou.ai/about" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="About - Stories of You" />
  <meta name="twitter:description" content="The personal story behind Stories of You and our mission to preserve family memories." />
  <meta name="twitter:image" content="og-image.jpg" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --brand-navy:#0f2c4c;
      --brand-orange:#e09a1b;
      --brand-charcoal:#3d3528;
      --warm-light:#faf3e7;
      --warm-mid:#e0cba7;
    }
    .site-header{position:sticky;top:0;z-index:40;background:rgba(255,255,255,.82);backdrop-filter:saturate(140%) blur(10px);box-shadow:0 6px 16px rgba(0,0,0,.06)}
    .hero-bg{background:radial-gradient(1200px 500px at 50% -200px,#fff7e9 0%,#fce8c8 50%,#e0cba7 100%)}
    .bg-warm-light{background-color:var(--warm-light)}
    .bg-warm-mid{background-color:var(--warm-mid)}
    .reveal{opacity:0;transform:translateY(12px);transition:opacity .6s ease,transform .6s ease}
    .reveal.visible{opacity:1;transform:none}
    .btn-primary{background-color:var(--brand-charcoal);color:#fff}
    .btn-primary:hover{background-color:#5a4d3a}
    .btn-secondary{background:#fff;color:var(--brand-charcoal);border:2px solid var(--brand-charcoal)}
    .btn-secondary:hover{background:#f7f2eb}
    
    .founder-photo {
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,.1);
      max-width: 400px;
      width: 100%;
      height: auto;
    }
    
    .prose {
      max-width: none;
    }
    .prose h2 {
      color: var(--brand-navy);
      font-size: 1.875rem;
      font-weight: 700;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    .prose h3 {
      color: var(--brand-charcoal);
      font-size: 1.5rem;
      font-weight: 600;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
    }
    .prose p {
      margin-bottom: 1.25rem;
      line-height: 1.7;
      color: #374151;
    }
    .prose strong {
      color: var(--brand-charcoal);
      font-weight: 600;
    }
    .prose a {
      color: var(--brand-orange);
      text-decoration: none;
    }
    .prose a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body class="bg-white text-gray-800 font-sans">

  <!-- Header -->
  <header class="site-header">
    <div class="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">
      <a href="/">
        <img src="logo.png" alt="Stories of You logo" class="h-8 w-auto rounded-sm" />
      </a>
      <nav class="hidden md:flex items-center space-x-6">
        <a href="/#faq" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">FAQ</a>
        <a href="/about.html" class="text-sm font-semibold transition-colors" style="color:var(--brand-navy)">About</a>
        <a href="/privacy.html" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">Privacy</a>
        <button id="openLoginModal" class="btn-secondary px-4 py-2 text-sm rounded-lg">Login</button>
        <button id="openRecorderNav" class="btn-primary px-4 py-2 text-sm rounded-lg">Record Story</button>
      </nav>
      <!-- Mobile menu button -->
      <button id="mobileMenuBtn" class="md:hidden text-gray-600 hover:text-gray-900">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
    <!-- Mobile menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-gray-200">
      <div class="px-6 py-3 space-y-3">
        <a href="/#faq" class="block text-sm text-gray-600 hover:text-gray-900">FAQ</a>
        <a href="/about.html" class="block text-sm font-semibold" style="color:var(--brand-navy)">About</a>
        <a href="/privacy.html" class="block text-sm text-gray-600 hover:text-gray-900">Privacy</a>
        <button id="openLoginMobile" class="btn-secondary px-4 py-2 text-sm rounded-lg w-full text-left">Login</button>
        <button id="openRecorderMobile" class="btn-primary px-4 py-2 text-sm rounded-lg w-full text-left">Record Story</button>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero-bg">
    <div class="mx-auto max-w-7xl px-6 py-14 text-center">
      <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight">About Stories of You</h1>
      <p class="mt-5 text-lg text-gray-900/80 max-w-2xl mx-auto">
        The personal story behind our mission to preserve family memories for generations.
      </p>
    </div>
  </section>

  <!-- Main Content -->
  <section class="bg-white py-16">
    <div class="max-w-4xl mx-auto px-6">
      <div class="prose text-lg">
        
        <!-- The Story Behind Our Story -->
        <div class="reveal">
          <h2>The Story Behind Our Story</h2>
          <p>Thirty years ago, my grandfather did something extraordinary. He set up his VHS camcorder, held up old family photographs one by one, and spent 40 minutes telling the stories behind each picture. His voice, his memories, his perspective on a lifetime of moments — all captured in his own words.</p>
          <p>That recording has become one of my most cherished possessions. I just wish he had done more.</p>
        </div>

        <!-- Founder Photo -->
        <div class="reveal my-12 text-center">
          <img src="founder-photo.jpg" alt="With my father - every generation has stories worth preserving" class="founder-photo mx-auto" />
          <p class="text-sm text-gray-600 mt-4 italic">With my father — every generation has stories worth preserving</p>
        </div>

        <!-- Why Stories Matter -->
        <div class="reveal">
          <h2>Why Stories Matter</h2>
          <p>Every time I listen to my grandfather's voice telling those stories, I'm reminded of something profound — <strong>throughout history, storytelling from generation to generation has been the critical component of our culture.</strong> Yet in our busy lives, we rarely take the time to capture these precious memories in the voices of the people we love most.</p>
          <p>I founded Stories of You because I believe everyone has a story to tell, and every family deserves to hear those stories preserved forever.</p>
        </div>

        <!-- Our Mission -->
        <div class="reveal">
          <h2>Our Mission: Safeguarding Stories for Generations</h2>
          <p><strong>We make storytelling accessible and meaningful for all.</strong> Using thoughtful technology, we prompt, capture, and transform life stories into beautiful keepsakes that honor the storyteller's authentic voice.</p>
          <p>Too often, the stories of our parents and grandparents are lost to time. Traditional approaches — writing memoirs, home videos, diary collections — are either too time-consuming or too impersonal to truly preserve the essence of a person. Families crave a way to capture personal legacies in the voice and words of their loved ones, but few solutions make it easy or engaging.</p>
          <p>That's where we come in.</p>
        </div>

        <!-- How We're Different -->
        <div class="reveal">
          <h2>How We're Different</h2>
          <p><strong>We believe your memories, values, and stories should be preserved in your own voice</strong> — in a way that feels as natural as conversation and as timeless as family albums.</p>
          <p>Our guided storytelling platform uses AI to prompt meaningful conversations, capture authentic stories, and weave them together into documentary-style videos. We add photographs and videos that bring stories to life while keeping the storyteller's voice at the center of everything.</p>
          <p>Whether it's preserving grandparent stories, celebrating milestone birthdays, creating digital time capsules for future generations, or simply making sure no family story goes untold, we're here to help.</p>
        </div>

        <!-- Your Stories Are Sacred -->
        <div class="reveal">
          <h2>Your Stories Are Sacred to Us</h2>
          <p>We understand the profound trust you place in us when you share your family's most precious memories. Your stories aren't just data to us — they're irreplaceable pieces of family history that deserve to be treated with the utmost care and respect.</p>
          <p><strong>Every story matters. Every voice deserves to be heard. Every family deserves to preserve their legacy.</strong></p>
        </div>

        <!-- CTA Section -->
        <div class="reveal">
          <h2>Start Preserving Your Stories Today</h2>
          <p>Don't let another generation of stories slip away. Whether you're looking to capture your own memories or invite someone you love to share theirs, we make it simple, meaningful, and genuinely enjoyable.</p>
          <p>Because thirty years from now, the voices we preserve today will become someone else's most cherished possession.</p>
        </div>

      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-warm-light py-16">
    <div class="max-w-4xl mx-auto text-center px-6">
      <h2 class="text-3xl font-bold text-gray-900 reveal">Ready to Begin?</h2>
      <p class="mt-4 text-lg text-gray-800 reveal">Start your first story session or learn more about how Stories of You works.</p>
      <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4 reveal">
        <button id="openRecorderBottom" class="btn-primary px-8 py-4 text-lg rounded-xl shadow transition">
          Record a Story (beta)
        </button>
        <a href="/" class="btn-secondary px-8 py-4 text-lg rounded-xl shadow transition">
          Learn How It Works
        </a>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section class="bg-warm-mid py-12">
    <div class="max-w-4xl mx-auto text-center px-6">
      <p class="text-lg text-gray-800 reveal">
        Have questions? We'd love to hear from you at 
        <a href="mailto:michael@storiesofyou.ai" class="font-semibold hover:underline" style="color:var(--brand-orange)">michael@storiesofyou.ai</a>
      </p>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-gray-300 py-8">
    <div class="max-w-7xl mx-auto px-6 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <img src="logo.png" alt="Stories of You logo" class="h-7 w-auto rounded-sm" />
        <span class="text-sm tracking-wide">© <span id="year"></span> Stories of You. All rights reserved.</span>
      </div>
      <a href="privacy.html" class="text-sm hover:text-white opacity-80">Privacy</a>
    </div>
  </footer>

  <!-- Recorder Modal (same as index.html) -->
  <div id="recModal" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-[60] p-4">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[95vh] flex flex-col">
      <div class="flex items-center justify-between p-4 border-b flex-shrink-0">
        <div class="flex items-center gap-2">
          <img src="logo.png" alt="Stories of You" class="h-6 w-auto" />
          <span class="text-sm font-semibold" style="color:var(--brand-navy)">Record Your Story</span>
        </div>
        <button id="recClose" class="text-gray-400 hover:text-gray-600 text-2xl leading-none" aria-label="Close">&times;</button>
      </div>
      <div class="p-5 space-y-4 overflow-y-auto flex-1">
        <!-- Identity -->
        <div class="grid md:grid-cols-2 gap-3">
          <div>
            <label class="block text-sm text-gray-600">Your name <span class="text-red-600">*</span></label>
            <input id="recName" type="text" class="w-full border rounded-md px-3 py-2" required />
          </div>
          <div>
            <label class="block text-sm text-gray-600">Email <span class="text-red-600">*</span></label>
            <input id="recEmail" type="email" class="w-full border rounded-md px-3 py-2" required />
          </div>
        </div>

        <!-- Prompt -->
        <label class="block text-sm text-gray-600">Choose a prompt (optional)</label>
        <select id="recPrompt" class="w-full border rounded-md px-3 py-2">
          <option value="">— Pick a prompt —</option>
          <option>Tell me about your first job.</option>
          <option>What was your childhood home like?</option>
          <option>How did you meet your partner or spouse?</option>
          <option>What's a favorite vacation memory?</option>
          <option>What's something you've never told anyone before?</option>
        </select>

        <!-- Consent -->
        <label class="flex items-start gap-2 text-sm text-gray-600">
          <input id="recConsent" type="checkbox" class="mt-1">
          I agree to have this recording stored and processed for the purpose of preserving my story.
        </label>

        <!-- Optional Photo -->
        <div>
          <label class="block text-sm text-gray-600">Add a photo (optional)</label>
          <input id="recPhoto" type="file" accept="image/jpeg,image/png,image/webp" class="w-full border rounded-md px-3 py-2" />
          <div id="recPhotoPreviewWrap" class="mt-2 hidden">
            <div class="flex items-center gap-3">
              <img id="recPhotoPreview" class="w-16 h-16 object-cover rounded-md border flex-shrink-0" alt="Selected photo preview" />
              <div class="flex-1 min-w-0">
                <p class="text-xs text-gray-500 break-words">Photo added ✓</p>
                <p class="text-xs text-gray-400">Max 1600px, compressed</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Meter + Timer -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <canvas id="recMeter" width="140" height="14" class="rounded bg-gray-100"></canvas>
            <span id="recStatus" class="text-sm text-gray-600">Ready</span>
          </div>
          <span id="recTimer" class="text-sm font-mono text-gray-700">00:00</span>
        </div>

        <div id="uploadMsg" class="text-sm text-gray-600 hidden"></div>
      </div>
      
      <!-- Fixed bottom section for action buttons -->
      <div id="actionButtons" class="p-4 border-t bg-gray-50 flex-shrink-0">
        <!-- Controls -->
        <div class="flex items-center gap-3 mb-3">
          <button id="btnRecord" class="btn-primary px-4 py-2 rounded-lg">Record</button>
          <button id="btnPause"  class="btn-secondary px-4 py-2 rounded-lg hidden">Pause</button>
          <button id="btnResume" class="btn-primary px-4 py-2 rounded-lg hidden">Resume</button>
          <button id="btnStop"   class="btn-secondary px-4 py-2 rounded-lg hidden">Stop</button>
        </div>

        <!-- Playback -->
        <div id="playbackWrap" class="hidden space-y-3">
          <audio id="recAudio" controls class="w-full"></audio>
          <div class="flex items-center gap-3">
            <button id="btnRerecord" class="btn-secondary px-4 py-2 rounded-lg">Re-record</button>
            <button id="btnUpload"   class="btn-primary px-4 py-2 rounded-lg">Use This</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-[60] p-4 overflow-y-auto">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[95vh] flex flex-col my-4">
      <div class="flex items-center justify-between p-4 border-b flex-shrink-0">
        <div class="flex items-center gap-2">
          <img src="logo.png" alt="Stories of You" class="h-6 w-auto" />
          <span class="text-sm font-semibold" style="color:var(--brand-navy)">Login to Your Storyboard</span>
        </div>
        <button id="loginClose" class="text-gray-400 hover:text-gray-600 text-2xl leading-none" aria-label="Close">&times;</button>
      </div>
      <div class="p-6 space-y-4 overflow-y-auto flex-1">
        <div id="loginForm">
          <div class="text-center mb-6">
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Welcome Back</h2>
            <p class="text-sm text-gray-600">Enter your email to receive a magic link</p>
          </div>
          
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
              <input 
                id="loginEmail" 
                type="email" 
                class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500" 
                placeholder="your@email.com"
                required 
              />
            </div>
            
            <button 
              id="sendLoginCode" 
              class="btn-primary w-full px-4 py-3 rounded-lg font-medium"
            >
              Send Magic Link
            </button>
          </div>
        </div>

        <div id="magicLinkForm" class="hidden">
          <div class="text-center mb-6">
            <div class="text-green-600 mb-4">
              <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
              </svg>
            </div>
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Check Your Email</h2>
            <p class="text-sm text-gray-600 mb-4">We sent a magic link to <span id="magicLinkEmailDisplay" class="font-medium"></span></p>
            <p class="text-sm text-gray-500">Click the link in your email to access your storyboard. The link will expire in 10 minutes.</p>
          </div>
          
          <div class="space-y-4">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <div class="flex items-start gap-3">
                <svg class="w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div>
                  <p class="text-sm text-blue-800 font-medium">Can't find the email?</p>
                  <p class="text-xs text-blue-600 mt-1">Check your spam folder or try requesting a new link below.</p>
                </div>
              </div>
            </div>
            
            <div class="flex gap-3">
              <button 
                id="resendMagicLink" 
                class="btn-secondary flex-1 px-4 py-3 rounded-lg font-medium"
              >
                Send New Link
              </button>
              <button 
                id="changeEmail" 
                class="btn-secondary px-4 py-3 rounded-lg font-medium"
              >
                Change Email
              </button>
            </div>
          </div>
        </div>

        <div id="loginLoading" class="hidden text-center py-8">
          <div class="loading-spinner mx-auto mb-4"></div>
          <p class="text-sm text-gray-600">Processing...</p>
        </div>

        <div id="loginSuccess" class="hidden text-center py-8">
          <div class="text-green-600 mb-4">
            <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">Login Successful!</h3>
          <p class="text-sm text-gray-600 mb-4">Redirecting to your storyboard...</p>
        </div>

        <div id="loginError" class="hidden p-3 bg-red-50 border border-red-200 rounded-lg">
          <p id="loginErrorText" class="text-sm text-red-600"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Scroll-in animations
    const revealEls=document.querySelectorAll('.reveal');
    const io=new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target); }});
    },{threshold:.15});
    revealEls.forEach(el=>io.observe(el));

    // Open recorder
    const recModal = document.getElementById('recModal');
    ['openRecorderNav','openRecorderMobile','openRecorderBottom'].forEach(id=>{
      const el=document.getElementById(id); if(el){el.addEventListener('click',()=>recModal.classList.remove('hidden'));}
    });

    // Close recorder
    const closeRec=document.getElementById('recClose');
    closeRec.addEventListener('click', ()=>recModal.classList.add('hidden'));

    // Mobile menu toggle
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }

    // =========================================================================
    // Recording functionality (same as index.html)
    // =========================================================================
    const INVOKE_URL = "https://6117txq5ok.execute-api.us-east-2.amazonaws.com";
    const METADATA_WEBHOOK = "https://stories.storiesofyou.ai/api/stories/submit";

    const nameEl=document.getElementById('recName');
    const emailEl=document.getElementById('recEmail');
    const promptEl=document.getElementById('recPrompt');
    const consentEl=document.getElementById('recConsent');
    const photoInput=document.getElementById('recPhoto');
    const photoPreviewWrap=document.getElementById('recPhotoPreviewWrap');
    const photoPreview=document.getElementById('recPhotoPreview');
    const meterCv=document.getElementById('recMeter');
    const mtx=meterCv.getContext('2d');
    const statusEl=document.getElementById('recStatus');
    const timerEl=document.getElementById('recTimer');
    const btnRecord=document.getElementById('btnRecord');
    const btnPause=document.getElementById('btnPause');
    const btnResume=document.getElementById('btnResume');
    const btnStop=document.getElementById('btnStop');
    const pbWrap=document.getElementById('playbackWrap');
    const audioEl=document.getElementById('recAudio');
    const btnRerec=document.getElementById('btnRerecord');
    const btnUpload=document.getElementById('btnUpload');
    const uploadMsg=document.getElementById('uploadMsg');

    let mediaStream, mediaRecorder, chunks=[];
    let audioCtx, analyser, dataArray, meterAnim;
    let startTime, timerInt, blob, mimeType;
    let photoFile=null;

    // Basic recording functionality (simplified for about page)
    btnRecord.addEventListener('click', async ()=>{
      try{
        mimeType = MediaRecorder.isTypeSupported('audio/mp4;codecs=aac') ? 'audio/mp4' : 'audio/webm';
        mediaStream = await navigator.mediaDevices.getUserMedia({audio:true});
        mediaRecorder = new MediaRecorder(mediaStream, mimeType ? {mimeType} : undefined);
        chunks=[];
        
        mediaRecorder.ondataavailable=e=>{ if(e.data.size) chunks.push(e.data); };
        mediaRecorder.onstart=()=>{ statusEl.textContent='Recording…'; };
        mediaRecorder.onstop=()=>{
          blob=new Blob(chunks,{type:mimeType||'audio/webm'});
          audioEl.src=URL.createObjectURL(blob);
          pbWrap.classList.remove('hidden');
          statusEl.textContent='Review your recording';
        };
        
        mediaRecorder.start();
        btnRecord.classList.add('hidden');
        btnStop.classList.remove('hidden');
      }catch(err){
        statusEl.textContent='Microphone access blocked. Please allow mic.';
      }
    });

    btnStop.addEventListener('click',()=>{
      if(mediaRecorder && mediaRecorder.state!=='inactive') mediaRecorder.stop();
      if(mediaStream) mediaStream.getTracks().forEach(t=>t.stop());
      btnStop.classList.add('hidden');
    });

    btnRerec.addEventListener('click',()=>{
      pbWrap.classList.add('hidden');
      statusEl.textContent='Ready';
      chunks=[]; blob=null; audioEl.src='';
      btnRecord.classList.remove('hidden');
    });

    // Simplified upload (just show message)
    btnUpload.addEventListener('click',()=>{
      if(!nameEl.value.trim() || !emailEl.value.trim() || !consentEl.checked){
        uploadMsg.textContent='Please fill in all required fields.';
        uploadMsg.classList.remove('hidden');
        return;
      }
      uploadMsg.textContent='Upload functionality coming soon in beta!';
      uploadMsg.classList.remove('hidden');
    });

    // Photo preview
    photoInput.addEventListener('change', (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f){ photoFile=null; photoPreviewWrap.classList.add('hidden'); return; }
      const url = URL.createObjectURL(f);
      photoPreview.src = url;
      photoPreviewWrap.classList.remove('hidden');
      photoFile = f;
    });

    // =========================================================================
    // Login Modal Functionality
    // =========================================================================
    (function(){
      const loginModal = document.getElementById('loginModal');
      const loginClose = document.getElementById('loginClose');
      const openLoginModal = document.getElementById('openLoginModal');
      const openLoginMobile = document.getElementById('openLoginMobile');
      
      const loginForm = document.getElementById('loginForm');
      const magicLinkForm = document.getElementById('magicLinkForm');
      const loginLoading = document.getElementById('loginLoading');
      const loginSuccess = document.getElementById('loginSuccess');
      const loginError = document.getElementById('loginError');
      const loginErrorText = document.getElementById('loginErrorText');
      
      const loginEmail = document.getElementById('loginEmail');
      const sendLoginCode = document.getElementById('sendLoginCode');
      const magicLinkEmailDisplay = document.getElementById('magicLinkEmailDisplay');
      const resendMagicLinkBtn = document.getElementById('resendMagicLink');
      const changeEmail = document.getElementById('changeEmail');
      
      let currentEmail = '';

      function openLogin() {
        loginModal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        resetLoginForm();
      }
      
      function closeLogin() {
        loginModal.classList.add('hidden');
        document.body.style.overflow = '';
        resetLoginForm();
      }
      
      function resetLoginForm() {
        loginForm.classList.remove('hidden');
        magicLinkForm.classList.add('hidden');
        loginLoading.classList.add('hidden');
        loginSuccess.classList.add('hidden');
        loginError.classList.add('hidden');
        loginEmail.value = '';
        currentEmail = '';
      }
      
      function showError(message) {
        loginErrorText.textContent = message;
        loginError.classList.remove('hidden');
        setTimeout(() => {
          loginError.classList.add('hidden');
        }, 5000);
      }
      
      async function sendMagicLink() {
        const email = loginEmail.value.trim();
        
        if (!email || !email.includes('@')) {
          showError('Please enter a valid email address');
          return;
        }
        
        currentEmail = email;
        
        loginForm.classList.add('hidden');
        loginLoading.classList.remove('hidden');
        loginError.classList.add('hidden');
        
        try {
          const response = await fetch('https://stories.storiesofyou.ai/api/generate-otp', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email: email })
          });
          
          const data = await response.json();
          
          if (data.success) {
            loginLoading.classList.add('hidden');
            magicLinkForm.classList.remove('hidden');
            magicLinkEmailDisplay.textContent = email;
          } else {
            throw new Error(data.message || 'Failed to send magic link');
          }
        } catch (error) {
          console.error('Send magic link error:', error);
          loginLoading.classList.add('hidden');
          loginForm.classList.remove('hidden');
          showError(error.message || 'Failed to send magic link. Please try again.');
        }
      }
      
      async function resendMagicLink() {
        if (!currentEmail) {
          showError('No email address found. Please start over.');
          return;
        }
        
        magicLinkForm.classList.add('hidden');
        loginLoading.classList.remove('hidden');
        loginError.classList.add('hidden');
        
        try {
          const response = await fetch('https://stories.storiesofyou.ai/api/generate-otp', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email: currentEmail })
          });
          
          const data = await response.json();
          
          if (data.success) {
            loginLoading.classList.add('hidden');
            magicLinkForm.classList.remove('hidden');
          } else {
            throw new Error(data.message || 'Failed to resend magic link');
          }
        } catch (error) {
          console.error('Resend magic link error:', error);
          loginLoading.classList.add('hidden');
          magicLinkForm.classList.remove('hidden');
          showError(error.message || 'Failed to resend magic link. Please try again.');
        }
      }
      
      function changeEmailAddress() {
        magicLinkForm.classList.add('hidden');
        loginForm.classList.remove('hidden');
        loginEmail.focus();
      }
      
      openLoginModal?.addEventListener('click', openLogin);
      openLoginMobile?.addEventListener('click', openLogin);
      loginClose?.addEventListener('click', closeLogin);
      sendLoginCode?.addEventListener('click', sendMagicLink);
      resendMagicLinkBtn?.addEventListener('click', resendMagicLink);
      changeEmail?.addEventListener('click', changeEmailAddress);
      
      loginEmail?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          sendMagicLink();
        }
      });
      
      loginModal?.addEventListener('click', (e) => {
        if (e.target === loginModal) {
          closeLogin();
        }
      });
    })();
  </script>
</body>
</html>
